f = open("payload.dll","rb")
content = f.read()
f.close()
delimiter = "########"
temp = content.split(delimiter)
xor_key = temp[1][1:10]
print("XORKEY : " + xor_key)
from binascii import hexlify

# Getting the start of the configuration
delimiter = "\x000123456789ABCDEF"
temp = content.split(delimiter)
encrypted_config = temp[1][8:]
print(hexlify(encrypted_config[0]))
def repeating_xor_encrypt(plaintext, key):
    ciphertext = bytearray()
    for i in range(len(plaintext)):
        ciphertext.append(ord(plaintext[i]) ^ ord(key[i % len(key)]))
    return ciphertext
data = repeating_xor_encrypt(encrypted_config, xor_key)

f = open("extracted_config.txt","wb")
f.write(data.split("\n")[0])
f.close()
#print(hexlify(data[:30]))
#print(data[:0x100])